# LiteLedger

**LiteLedger** is a lightweight, tamper-proof, append-only Relational Database Management System (RDBMS) written in Go. It is designed to demonstrate core database concepts such as log-structured storage, in-memory indexing, and cryptographic data integrity, all without external dependencies.

## ğŸš€ Features

*   **Append-Only Storage:** Uses a Log-Structured File System pattern where all writes (inserts, updates, deletes) are appended to the end of the file, preserving a complete history of changes.
*   **Tamper-Proof Security:** Every row is secured with a **SHA-256 checksum**. The system automatically verifies data integrity on read, triggering a security alert if data has been modified externally.
*   **In-Memory Indexing:** Utilizes a Hash Index (`map[string]offset`) for O(1) primary key lookups.
*   **SQL Support:** Supports a strict subset of SQL, including:
    *   `CREATE TABLE`
    *   `INSERT INTO`
    *   `SELECT` (by ID or Column)
    *   `UPDATE`
    *   `DELETE`
    *   `SHOW TABLES`
*   **Persistent Metadata:** Automatically saves and recovers table schemas and indexes across restarts.
*   **Modern Web Dashboard:** A responsive, dark-themed Single Page Application (SPA) for interacting with the ledger, featuring real-time search and transaction management.

## ğŸ› ï¸ Architecture

### Storage Engine
*   **Pattern:** Log-Structured (Append-Only).
*   **Format:** Pipe-delimited text files (`data/table_name.db`).
*   **Row Structure:** `id|active_flag|col1|col2|...|sha256_checksum\n`
    *   `active_flag`: `1` for active records, `0` for tombstones (deleted records).

### Indexing
*   **Type:** In-Memory Hash Index.
*   **Logic:** Maps Primary Keys to byte offsets in the file. Rebuilt sequentially from the log file on startup.

## ğŸ“¦ Getting Started

### Prerequisites
*   [Go 1.21+](https://go.dev/dl/) installed.

### Running the Project

1.  Clone the repository:
    ```bash
    git clone https://github.com/yourusername/pesapal-ledger.git
    cd pesapal-ledger
    ```

2.  Start the server:
    ```bash
    go run .
    ```

3.  Open your browser and navigate to:
    ```
    http://localhost:8080
    ```

## ğŸ’» Usage

### Web Interface
The dashboard provides a user-friendly interface to:
*   **Initialize System:** Create the necessary tables.
*   **Record Transaction:** Add new entries to the ledger.
*   **Audit Ledger:** Search for transactions by ID or Merchant name.
*   **Demo Mode:** Automatically populate the ledger with sample data.

### SQL Examples
You can also interact via the API endpoint `/sql`:

```sql
-- Create a table
CREATE TABLE transactions (id int, merchant text, amount int)

-- Insert a record
INSERT INTO transactions VALUES (101, Starbucks, 550)

-- Select by ID
SELECT * FROM transactions WHERE id = 101

-- Select by Merchant
SELECT * FROM transactions WHERE merchant = Starbucks

-- Update a record
UPDATE transactions SET amount=600 WHERE id=101

-- Delete a record (Soft Delete)
DELETE FROM transactions WHERE id=101
```

## ğŸ“‚ Project Structure

```
pesapal-ledger/
â”œâ”€â”€ engine/         # Core database logic (indexes, CRUD, metadata)
â”œâ”€â”€ storage/        # Low-level file I/O and SHA-256 security
â”œâ”€â”€ parser/         # SQL parsing and query routing
â”œâ”€â”€ web/            # Web interface (HTML/JS/CSS)
â”œâ”€â”€ data/           # Database files (.db) and metadata (autogenerated)
â”œâ”€â”€ docs/           # Documentation and plans
â”œâ”€â”€ main.go         # Entry point and HTTP server
â””â”€â”€ go.mod          # Go module definition
```

## ğŸ“„ License

This project is open source and available under the [MIT License](LICENSE).
